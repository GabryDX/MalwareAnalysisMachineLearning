import re


def bernoulli_nbc(doc, safe, malware, n_safe, n_malware, dic):
	p_safe, p_malware = 1.0, 1.0
	for s in dic:
		if s in safe.keys():
			p_s = (safe[s] + 1) / (n_safe + 2)
		else:
			p_s = 1 / (n_safe + 2)
		if s in malware.keys():
			p_m = (malware[s] + 1) / (n_malware + 2)
		else:
			p_m = 1 / (n_malware + 2)
		if s in doc:
			p_safe *= p_s
			p_malware *= p_m
		else:
			p_safe *= (1 - p_s)
			p_malware *= (1 - p_m)
	t = max(p_safe, p_malware)
	if t == p_safe:
		return 'safe'
	elif t == p_malware:
		return 'malware'
